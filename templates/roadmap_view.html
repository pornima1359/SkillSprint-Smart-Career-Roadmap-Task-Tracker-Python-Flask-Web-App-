<!DOCTYPE html>
<html>
<head>
  <title>Roadmaps - SkillSprint</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="topbar">
  <h2>ðŸ§­ Your Roadmaps</h2>
  <div class="nav">
    <a class="btn secondary" href="/dashboard">Dashboard</a>
    <a class="btn" href="/roadmap/create">âž• Create Roadmap</a>
    <a class="btn secondary" href="/tasks">Tasks</a>
    <a class="btn secondary" href="/progress">Progress</a>
    <a class="btn" href="/logout">Logout</a>
  </div>
</div>

<div class="container">
  <h1>ðŸ“Œ Roadmap Plans</h1>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert {{category}}">{{message}}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% if roadmap_names|length == 0 %}
    <div class="card">
      <p class="muted">No roadmap created yet.</p>
      <a class="btn" href="/roadmap/create">Create your first roadmap</a>
    </div>
  {% else %}

    <div class="card">
      <h3>ðŸ“‚ Select Roadmap</h3>
      <div class="chips">
        {% for name in roadmap_names %}
          <a class="chip-link" href="/roadmaps?name={{name}}">{{name}}</a>
        {% endfor %}
      </div>

      <div style="margin-top:10px;">
        <a class="btn secondary" href="/roadmap/export/{{active_name}}">â¬‡ Export CSV</a>
        <a class="btn danger" href="/roadmap/delete/{{active_name}}" onclick="return confirm('Delete roadmap?')">ðŸ—‘ Delete</a>
      </div>
    </div>

    <div class="card">
      <h3>ðŸ“Š Roadmap Progress: {{active_name}}</h3>
      <p><b>{{percent_active}}%</b> Completed ({{done_active}} / {{total_active}})</p>

      <div class="progress-bar">
        <div class="progress-fill" style="width: {{percent_active}}%;"></div>
      </div>
    </div>

    <div class="card">
      <h3>ðŸ§© Roadmap Items</h3>

      {% if items|length == 0 %}
        <p class="muted">No items found.</p>
      {% else %}
        {% for r in items %}
          <div class="row">
            <div>
              <b>{{r[2]}}</b> - Week {{r[3]}} : {{r[4]}}
              <span class="status {{r[5]}}">{{r[5]}}</span>
            </div>

            {% if r[5] != "Done" %}
              <a class="btn small" href="/roadmap/done/{{r[0]}}">Mark Done</a>
            {% endif %}
          </div>
        {% endfor %}
      {% endif %}
    </div>

  {% endif %}
</div>

</body>
</html>
